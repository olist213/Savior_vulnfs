-- MySQL dump 10.13  Distrib 5.7.37, for Linux (x86_64)
--
-- Host: localhost    Database: savior
-- ------------------------------------------------------
-- Server version	5.7.37

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `api_program`
--

DROP TABLE IF EXISTS `api_program`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `api_program` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `program_type` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `program_vul_name` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  `program_describe` varchar(1000) COLLATE utf8mb4_unicode_ci NOT NULL,
  `program_repair` varchar(1000) COLLATE utf8mb4_unicode_ci NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `program_vul_name` (`program_vul_name`)
) ENGINE=InnoDB AUTO_INCREMENT=120 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `api_program`
--

LOCK TABLES `api_program` WRITE;
/*!40000 ALTER TABLE `api_program` DISABLE KEYS */;
INSERT INTO `api_program` VALUES (3,'WEB漏洞','Apache样例文件泄漏','apache一些样例文件没有删除，可能存在cookie、session伪造，进行后台登录操作','1、删除样例文件\n2、对apache中web.xml进行相关设置'),(4,'WEB漏洞','弱口令','由于系统中存在有弱口令，导致攻击者通过弱口令可轻松登录系统中，从而进行下一步的攻击，如上传webshell，获取敏感数据！\n另外攻击者利用弱口令登录网站管理后台，可任意增删改等操作，从而造成负面影响！','1、建议强制用户首次登录时修改默认口令，或是使用用户自定义初始密码的策略；\n2、 完善密码策略，信息安全最佳实践的密码策略为8位（包括）以上字符，包含数字、大小写字母、特殊字符中的至少3种。\n3、对管理后台进行访问控制，修改后台弱口令，加强口令强度并定期修改。\n4、增加验证机制，防爆破机制，限制ip＋cookie访问次数。'),(5,'WEB漏洞','明文传输登录口令','用户登录过程中使用明文传输用户登录信息，若用户遭受中间人攻击时，攻击者可直接获取该用户登录账户，从而进行进一步渗透。','1、用户登录信息使用加密传输，如密码在传输前使用安全的算法加密后传输，可采用的算法包括：不可逆hash算法加盐（4位及以上随机数，由服务器端产生）；安全对称加密算法，如AES(128、192、256位)，且必须保证客户端密钥安全，不可被破解或读出；非对称加密算法，如RSA(不低于1024位)、SM2等。\n2、使用https来保证传输的安全。'),(6,'WEB漏洞','暴力破解','由于没有对登录页面进行相关的防暴力破解机制，如无验证码、有验证码但验证码未在服务器端校验以及无登录错误次数限制等，导致攻击者可通过暴力破解获取用户登录账户及口令，从而获取网站登录访问权限！','1、添加验证码机制，加入图片（验证码动态生成且满足随机性）或者短信验证码（验证码具备超时时限一般为1分钟，且在该时限内错误次数超过3次则进行锁定1分钟后方能重新获取验证码，超时后验证码自动失效）！\n2、验证码必须在服务器端进行校验，客户端的一切校验都是不安全的！'),(7,'WEB漏洞','sql注入漏洞','Web程序代码中对于用户提交的参数未做过滤就直接放到SQL语句中执行，导致参数中的特殊字符打破了SQL语句原有逻辑，黑客可以利用该漏洞执行任意SQL语句，如查询数据、下载数据、写入webshell、执行系统命令以及绕过登录限制等。','代码层最佳防御sql漏洞方案：采用sql语句预编译和绑定变量，是防御sql注入的最佳方法。\n1）所有的查询语句都使用数据库提供的参数化查询接口，参数化的语句使用参数而不是将用户输入变量嵌入到SQL语句中。当前几乎所有的数据库系统都提供了参数化SQL语句执行接口，使用此接口可以非常有效的防止SQL注入攻击。\n2）对进入数据库的特殊字符（’”<>&*;等）进行转义处理，或编码转换。\n3）确认每种数据的类型，比如数字型的数据就必须是数字，数据库中的存储字段必须对应为int型。\n4）数据长度应该严格规定，能在一定程度上防止比较长的SQL注入语句无法正确执行。\n5）网站每个数据层的编码统一，建议全部使用UTF-8编码，上下层编码不一致有可能导致一些过滤模型被绕过。\n6）严格限制网站用户的数据库的操作权限，给此用户提供仅仅能够满足其工作的权限，从而最大限度的减少注入攻击对数据库的危害。\n7）避免网站显示SQL错误信息，比如类型错误、字段不匹配等，防止攻击者利用这些错误信息进行一些判断。'),(8,'WEB漏洞','跨站脚本攻击（xss）漏洞','1）、Web程序代码中把用户提交的参数未做过滤或过了不严就直接输出到页面，参数中的特殊字符打破了HTML页面的原有逻辑，黑客可以利用该漏洞执行恶意HTML/JS代码、构造蠕虫传播、篡改页面实施钓鱼攻击、诱以及导用户再次登录，然后获取其登录凭证等。\n2）、XSS攻击对Web服务器本身虽无直接危害，但是它借助网站进行传播，对网站用户进行攻击，窃取网站用户账号信息等，从而也会对网站产生较严重的危害。XSS攻击可导致以下危害：\n3）、钓鱼欺骗：最典型的就是利用目标网站的反射型跨站脚本漏洞将目标网站重定向到钓鱼网站，或者通过注入钓鱼JavaScript脚本以监控目标网站的表单输入，甚至攻击者基于DHTML技术发起更高级的钓鱼攻击。\n4）、网站挂马：跨站时，攻击者利用Iframe标签嵌入隐藏的恶意网站，将被攻击者定向到恶意网站上、或弹出恶意网站窗口等方式，进行挂马攻击。\n5）、身份盗用：Cookie是用户对于特定网站的身份验证标志，XSS攻击可以盗取用户的cookie，从而利用该cookie盗取用户对该网站的操作权限。如果一个网站管理员用户的cookie被窃取，将会对网站引发巨大的危害。\n6）、盗取网站用户信息：当窃取到用户cookie从而获取到用户身份时，攻击者可以盗取到用户对网站的操作权限，从而查看用户隐私信息。\n7）、垃圾信息发送：在社交网站社区中，利用XSS漏洞借用被攻击者的身份发送大量的垃圾信息给特定的目标群。\n8）、劫持用户Web行为：一些高级的XSS攻击甚至可以劫持用户的Web行为，从而监视用户的浏览历史、发送与接收的数据等等。\n9）、XSS蠕虫：借助XSS蠕虫病毒还可以用来打广告、刷流量、挂马、恶作剧、破坏网上数据、实施DDoS攻击等。','xss漏洞本质上是一种html注入，也就是将html代码注入到网页中。那么其防御的根本就是在将用户提交的代码显示到页面上时做好一系列的过滤与转义\n1）假定所有输入都是可疑的，必须对所有输入中的script、iframe等字样进行严格的检查。这里的输入不仅仅是用户可以直接交互的输入接口，也包括HTTP请求中的Cookie中的变量，HTTP请求头部中的变量等。\n2）不仅要验证数据的类型，还要验证其格式、长度、范围和内容。\n3）不要仅仅在客户端做数据的验证与过滤，关键的过滤步骤在服务端进行。\n4）对输出的数据也要检查，数据库里的值有可能会在一个大网站的多处都有输出，即使在输入做了编码等操作，在各处的输出点时也要进行安全检查。'),(9,'WEB漏洞','目标服务器启用了不安全HTTP方法','目标服务器启用了不安全的传输方法，如PUT、TRACE、DELETE、MOVE等，这些方法表示可能在服务器上使用了 WebDAV，由于dav方法允许客户端操纵服务器上的文件，如上传、修改、删除相关文件等危险操作，如果没有合理配置dav，有可能允许未授权的用户对其进行利用，修改服务器上的文件。','1）、关闭不安全的传输方法，推荐只使用POST、GET方法！\n2）、如果服务器不需要支持 WebDAV，请务必禁用它。\n或者为允许webdav的目录配置严格的访问权限，如认证方法，认证需要的用户名，密码。'),(10,'WEB漏洞','任意文件上传','文件上传漏洞通常由于网页代码中的文件上传路径变量过滤不严或webserver相关解析漏洞未修复而造成的，如果文件上传功能实现代码没有严格限制用户上传的文件后缀以及文件类型，攻击者可通过 Web 访问的目录上传任意文件，包括网站后门文件（webshell），进而远程控制网站服务器。\n攻击者可通过此漏洞上传恶意脚本文件，对服务器的正常运行造成安全威胁！','1）、对上传文件类型进行限制，并且不能只做前端的限制，而要前端和后端一起限制，后端可以进行扩展名检测，重命名文件，MIME类型检测以及限制上传文件的大小，或是将上传的文件放在安全的路径下，尽量放于webserver之外的远程服务器等。\n2）、严格限制和校验上传的文件，禁止上传恶意代码的文件。同时限制相关目录的执行权限，防范webshell攻击。\n3）、对上传文件格式进行严格校验及安全扫描，防止上传恶意脚本文件；\n4）、设置权限限制，禁止上传目录的执行权限；\n5）、严格限制可上传的文件类型；\n6）、严格限制上传的文件路径。\n7）、文件扩展名服务端白名单校验。\n8）、文件内容服务端校验。\n9）、上传文件重命名。\n10）、隐藏上传文件路径。'),(11,'WEB漏洞','测试页面泄漏在外网','一些测试页面泄漏到外网，导致外界误传公司被黑客入侵，影响公司声誉。','删除测试页面以及无用文件，例如test.cgi，phpinfo.php，info.pho， .svn/entries等。'),(12,'WEB漏洞','目录浏览','由于服务器端配置不当，开启了目录浏览，黑客可获得服务器上的文件目录结构，从而下载敏感文件。','通过修改配置文件，去除中间件（如IIS、apache、tomcat）的文件目录索引功能\n2.设置目录权限\n3.在每个目录下创建一个空的index.html页面。'),(13,'WEB漏洞','phpinfo信息泄漏','Web站点的某些测试页面可能会使用到PHP的phpinfo()函数，会输出服务器的关键信息，从而造成信息泄露，通过获取的信息可进行下一步的攻击计划','删除该PHP文件'),(14,'WEB漏洞','未授权访问','未授权访问漏洞，是在攻击者没有获取到登录权限或未授权的情况下，或者不需要输入密码，即可通过直接输入网站控制台主页面地址，或者不允许查看的链接便可进行访问，同时进行操作；该系统','常见的修复方法：在系统中，加入用户身份认证机制或者tonken验证，防止可被直接通过连接就可访问到用户的功能进行操作，简而言之，一定对系统重要功能点增加权限控制，对用户操作进行合法性验证，下列为针对常见的JSP语言编写的网站的安全修复方案：\n\n1.采用JAVA过滤器技术，对/pages下所有URL进行登录状态检查，通过session.getAttribute()方法从session中获取登录成功时存入session中的身份标识，判断客户端传递过来的身份标识是否与session中保存的一致，不一致则跳转到登录页面。'),(15,'WEB漏洞','越权访问','由于没有对用户访问角色的权限进行严格的检查及限制，导致当前账号可对其他账号进行相关操作，如查看、修改等','对用户访问角色的权限进行严格的检查及限制'),(16,'WEB漏洞','命令执行漏洞','命令执行漏洞是指代码未对用户可控参数做过滤，导致直接带入执行命令的代码中，对恶意构造的语句，可被用来执行任意命令。黑客可在服务器上执行任意命令，写入后门，从而入侵服务器，获取服务器的管理员权限，危害巨大。','严格过滤用户输入的数据，禁止执行非预期系统命令'),(17,'WEB漏洞','应用程序错误信息泄露','黑客可通过特殊的攻击向量，使web服务器出现500、404等相关错误，导致信息泄漏如绝对路径、webserver版本、源代码、sql语句等敏感信息，恶意攻击者很有可能利用这些信息实施进一步的攻击。','1、自定义错误页面或归一化错误页面信息提示\n2、修正代码'),(18,'WEB漏洞','LDAP注入','由于Web 应用程序没有对用户提供的输入进行适当过滤和检查，攻击者便有可能修改LDAP 语句的结构，并且以（例如：数据库服务器、Web 应用程序服务器、Web 服务器）的权限执行任意命令，许可权可能会允许查询、修改或除去 LDAP 树状构造内任何数据。','对用户的输入进行严格的过滤及检查，并且对类型也进行检查'),(19,'WEB漏洞','文件包含漏洞','本地文件包含是指程序代码在处理包含文件的时候没有严格控制。利用这个漏洞，攻击者可以先把上传的静态文件，或网站日志文件作为代码执行，或者包含远程服务器上的恶意文件，进而获取到服务器权限。','1、严格检查变量是否已经初始化。\n2、对所有输入提交可能包含的文件地址，包括服务器本地文件及远程文件，进行严格的检查，参数中不允许出现../之类的目录跳转符。\n3、严格检查include类的文件包含函数中的参数是否外界可控。\n4、不要仅仅在客户端做数据的验证与过滤，关键的过滤步骤在服务端进行。'),(20,'WEB漏洞','网站敏感压缩文件泄露','误将网站备份文件或是敏感信息文件存放在某个网站目录下，外部黑客可通过暴力破解文件名等方法下载该备份文件，导致网站敏感信息泄露。','1、不要在网站目录下存放网站备份文件或敏感信息的文件。\n2、如需存放该类文件，请将文件名命名为难以猜解的字符串。'),(21,'WEB漏洞','CRLF HTTP 头部注入漏洞','CRLF 是“回车 +换行”（\\r\\n）的简称。在 HTTP 协议中，HTTPHeader 与 HTTP Body 是用两个 CRLF 符号进行分隔的，浏览器根据这两个 CRLF 符号来获取 HTTP 内容并显示。因此，一旦攻击者能够控制 HTTP 消息头中的字符，注入一些恶意的换行，就能注入一些会话 Cookie 或者 HTML 代码。','过滤 \\r 、\\n 之类的换行符，避免输入的数据污染到其他 HTTP 消息头。'),(22,'WEB漏洞','URL 跳转漏洞','Web 程序直接跳转到参数中的 URL ，或页面引入任意的开发者 URL，被攻击者利用可实施钓鱼攻击等操作。','在控制页面转向的地方校验传入的URL是否为可信域名。'),(23,'WEB漏洞','Crossdomain.xml 配置不当','网站根目录下的 crossdomain.xml 文件指明了远程Flash 是否可以加载当前网站的资源（图片、网页内容、Flash等）。如果配置不当，可能导致遭受跨站请求伪造（CSRF）攻击。','对于不需要从外部加载资源的网站，在 crossdomain.xml 文件中更改allow-access-from的domain属性为域名白名单。'),(24,'WEB漏洞','敏感信息泄露','在页面中或者返回的响应包中泄露了敏感信息，通过这些信息，攻击者可进一步渗透。','1、如果是探针或测试页面等无用的程序建议删除，或者修改不易被猜到的名字。\n2、禁用泄露敏感信息的页面或应用。\n3、对相关敏感信息进行模糊化处理，在服务器端进行！\n4、对服务器端返回的数据进行严格的检查，满足查询数据与页面显示数据一致，切勿返回多于的数据！'),(25,'WEB漏洞','任意文件下载','文件下载处由于未对下载路径进行过滤，利用路径回溯符../跳出程序本身的限制目录实现来下载任意文件，如下载系统密码文件等！','对下载路径进行过滤，如下载前对传入的参数进行过滤，并且对下载文件类型进行检查，是否是允许下载的类型，另外禁止使用回溯符../！'),(26,'WEB漏洞','weblogic SSRF服务器请求伪造','目标存在weblogic SSRF服务器请求伪造漏洞。WebLogic是用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。SSRF(Server-Side Request Forgery:服务器端请求伪造) 是一种由攻击者构造形成由服务端发起请求的一个安全漏洞。一般情况下，SSRF攻击的目标是从外网无法访问的内部系统。（正是因为它是由服务端发起的，所以它能够请求到与它相连而与外网隔离的内部系统）。Weblogic中间件默认带有“UDDI 目录浏览器”且为未授权访问，通过该应用，可进行无回显的SSRF请求。攻击者可利用该漏洞对企业内网进行大规模扫描，了解内网结构，并可能结合内网漏洞直接获取服务器权限。','1.删除uddiexplorer文件夹\n2.限制uddiexplorer应用只能内网访问'),(27,'WEB漏洞','目标站点存在网马','经渗透测试发现目标站点存在有webshell，攻击者可进行远程连接操作，进行恶意操作','1）删除可疑文件，并进行本地文件漏洞扫描排查是否还存在有其他木马！\n2）使用相关手段发现并及时修复已存在的漏洞！'),(28,'WEB漏洞','IIS短文件名泄露漏洞','Internet Information Services（IIS，互联网信息服务）是由微软公司提供的基于运行Microsoft windows的互联网基本服务。Microsoft IIS在实现上存在文件枚举漏洞，攻击者可利用此漏洞枚举网络服务器根目录中的文件。\n危害：攻击者可以利用“~”字符猜解或遍历服务器中的文件名，或对IIS服务器中的.Net Framework进行拒绝服务攻击。\n黑客可通过该漏洞尝试获取网站服务器下存放文件的文件名，达到获取更多信息来入侵服务器的目的。','修改Windows配置，关闭短文件名功能。\n1.关闭NTFS 8.3文件格式的支持。该功能默认是开启的，对于大多数用户来说无需开启。\n2.如果是虚拟主机空间用户,可采用以下修复方案：\n1）修改注册列表HKLM\\SYSTEM\\CurrentControlSet\\Control\\FileSystem\\NtfsDisable8dot3NameCreation的值为1(此修改只能禁止NTFS8.3格式文件名创建,已经存在的文件的短文件名无法移除)。\n2）如果你的web环境不需要asp.net的支持你可以进入Internet 信息服务(IIS)管理器 --- Web 服务扩展 - ASP.NET 选择禁止此功能。\n3）升级net framework 至4.0以上版本。\n3.将web文件夹的内容拷贝到另一个位置，比如D:\\www到D:\\www.back，然后删除原文件夹D:\\www，再重命名D:\\www.back到D:\\www。如果不重新复制，已经存在的短文件名则是不会消失的。'),(29,'WEB漏洞','Apache Struts2 远程代码执行漏洞（S2-019）','Apache Struts2的“Dynamic MethodInvocation”机制是默认开启的，仅提醒用户如果可能的情况下关闭此机制，如果未关闭此机制将导致远程代码执行漏洞，远程攻击者可利用此漏洞在受影响应用上下文中执行任意代码','1、目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载！\n2、或者手工设置struts.xml文件<constantname=\"struts.enable.DynamicMethodInvocation\"value=\"false\"/>'),(30,'WEB漏洞','Apache Struts2 远程代码执行漏洞（S2-037）','Apache Struts2在使用REST插件时，攻击者可以绕过动态方法执行的限制，调用恶意表达式执行远程代码。','建议用户到官方获取最新补丁或者最新版本程序！'),(31,'WEB漏洞','Apache Struts2 DevMode 远程代码执行漏洞','为了便于开发人员调试程序，Struts2提供了一个devMode模式，可以方便查看程序错误以及日志等信息。当Struts2中的devMode模式设置为true时，存在严重远程代码执行漏洞。如果WebService 启动权限为最高权限时，可远程执行任意命令，包括关机、建立新用户、以及删除服务器上所有文件等等','建议用户到官方获取最新补丁或者最新版本程序！\n或者将struts.properties中的devMode设置为false，或是在struts.xml中添加如下代码：<constant name=\"struts.devMode\"value=\"false\"/>。'),(32,'WEB漏洞','Apache Struts2 远程代码执行漏洞（S2-045）','Apache Struts2的Jakarta Multipartparser插件存在远程代码执行漏洞，漏洞编号为CVE-2017-5638。攻击者可以在使用该插件上传文件时，修改HTTP请求头中的Content-Type值来触发该漏洞，导致远程执行代码。','检测方式查看web目录下/WEB-INF/lib/目录下的struts-core.x.x.jar ，如果这个版本在Struts2.3.5 到 Struts2.3.31 以及 Struts2.5 到 Struts2.5.10之间则存在漏洞！\n1、建议用户到官方获取最新补丁或者最新版本程序！\n2、更新至Strusts2.3.32或者Strusts2.5.10.1，或使用第三方的防护设备进行防护。\n3、临时解决方案：删除commons-fileupload-x.x.x.jar文件（会造成上传功能不可用）。\n4、修改WEB-INF/classes目录下的配置\n在WEB-INF/classes目录下的struts.xml中的struts 标签下添加\n<constantname=”struts.custom.i18n.resources”value=”global”/>；\n在WEB-INF/classes/目录下添加global.properties，文件内容如下:\nstruts.messages.upload.error.InvalidContentTypeException=1'),(33,'WEB漏洞','Apache Struts2 远程代码执行漏洞（S2-033）','Apache Struts2在开启动态方法调用（DynamicMethod Invocation）的情况下，攻击者使用REST插件调用恶意表达式可以远程执行代码。','1、用户到官方获取最新补丁或者最新版本程序！\n2、或者在允许的情况下禁用动态方法调用（Dynamic Method Invocation），修改Struts2的配置文件struts.xml，将struts.enable.DynamicMethodInvocation设置为“false”。'),(34,'WEB漏洞','目标URL存在httphost头攻击漏洞','为了方便的获得网站域名，开发人员一般依赖于HTTP Host header，但是这个header是不可信赖的，如果应用程序没有对host header值进行处理，就有可能造成恶意代码的传入。','web应用程序应该使用SERVER_NAME而不是host header。\n在Apache和Nginx里可以通过设置一个虚拟机来记录所有的非法host header。在Nginx里还可以通过指定一个SERVER_NAME名单，Apache也可以通过指定一个SERVER_NAME名单并开启UseCanonicalName选项。'),(35,'WEB漏洞','登录绕过漏洞','由于对登录的账号及口令校验存在逻辑缺陷，或再次使用服务器端返回的相关参数作为最终登录凭证，导致可绕过登录限制，如服务器返回一个flag参数作为登录是否成功的标准，但是由于代码最后登录是否成功是通过获取这个flag参数来作为最终的验证，导致攻击者通过修改flag参数即可绕过登录的限制','修改验证逻辑，如是否登录成功服务器端返回一个参数，但是到此就是最终验证，不需要再对返回的参数进行使用并作为登录是否成功的最终判断依据'),(36,'WEB漏洞','短信/邮件轰炸','由于没有对短信或者邮件发送次数进行限制，导致可无限次发送短信或邮件给用户，从而造成短信轰炸，进而可能被大量用户投诉，从而影响公司声誉！','对发送短信或邮件的次数进行限制，如1分钟只能发送1次短信或邮件，并且需要在服务器进行限制！'),(37,'WEB漏洞','slow http Dos拒绝服务','按照设计，HTTP协议要求服务器在处理之前完全接收请求。如果HTTP请求没有完成，或者传输速率非常低，服务器会保持其资源忙于等待其余数据。如果服务器保持太多的资源忙，这将造成一个拒绝服务。严重者一台主机即可让web运行缓慢甚至是崩溃！','对于 Apache 可以做以下优化：\n设置合适的 timeout 时间（Apache 已默认启用了 reqtimeout 模块），规定了 Header 发送的时间以及频率和 Body 发送的时间以及频率\n增大 MaxClients(MaxRequestWorkers)：增加最大的连接数。根据官方文档，两个参数是一回事，版本不同，MaxRequestWorkers was called MaxClients before version 2.3.13.Theold name is still supported.\n默认安装的 Apache 存在 Slow Attack 的威胁，原因就是虽然设置的 timeoute，但是最大连接数不够，如果攻击的请求频率足够大，仍然会占满Apache的所有连接。'),(38,'WEB漏洞','web服务测试页面信息泄露','由于没有删除默认的且与业务无关的页面，导致信息泄露，如：webserver版本信息、中间件类型及版本信息等，通过对这类信息的收集，攻击者可制定具有针对性的攻击计划！','删除与业务无关的页面，如果是必须需要使用的中间件管理页面，建议对该页面进行访问权限的控制！'),(39,'WEB漏洞','Robots文件信息泄露','Robots协议是网站国际互联网界通行的道德规范，其目的是保护网站数据和敏感信息、确保用户个人信息和隐私不被侵犯，如果robots.txt文件编辑的太过详细，反而会泄露网站的敏感目录或者文件，比如网站后台路径，从而得知其使用的系统类型，从而有针对性地进行利用','删除文件或把敏感信息去除。'),(40,'WEB漏洞','java反序列化漏洞','渗透测试人员发现，该应用/中间件存在java反序列化漏洞,','联系官方升级相关中间件或自行升级对应jar包版本/jdk版本。'),(41,'WEB漏洞','服务器端Banner泄漏','渗透测试人员发现，','1.在服务器端返回的响应数据包中应避免返回服务器的配置和版本信息等。\n\n2.使用防火墙过滤掉返回的服务器配置和版本信息等。'),(42,'WEB漏洞','跨源资源共享配置不当','为避免该配置产生浏览器报错，部分Web框架将Access-Control-Allow-Origin:*与Access-Control-Allow-Credentials:true转换为反射Origin，导致产生安全问题','【1】关闭不必要开启的CORS，白名单限制：定义“源”的白名单，避免使用正则表达式，不要配置 Access-Control-Allow-Origin 为通配符 * 或 null ，严格效验来自请求数据包中的 Origin 的值\n\n【2】避免将 Access-Control-Allow-Credentials 标头设置为默认值 true ，跨域请求若不存在必要的凭证数据，则根据实际情况将其设置为 false'),(43,'WEB漏洞','此条非问题项，无需整改','此条非问题项，无需整改，参数未发现漏洞。','此条非问题项，无需整改'),(54,'WEB漏洞','用户名可枚举','存在于系统登录页面，利用登陆时输入系统存在的用户名错误密码和不存在的用户名错误密码，返回不同的出错信息可枚举出系统中存在的账号信息。','1，将登录失败的返回包统一定义为“用户名或密码错误”；\n2，增加校验机制，如：采用具有失效机制的验证码。'),(55,'WEB漏洞','验证码功能缺陷','web应用系统登录页面处，验证码不失效可重复使用，可进行暴力破解。','1，设计机器不易识别的验证码，实时更新验证码，并在服务器端进行验证。'),(56,'WEB漏洞','固定会话攻击','在用户登录应用系统前，就已经产生了一个session，用户登录以后，session的id不会改变，应用系统没有产生新的session，原来的session也没有被销毁, 攻击者可能会窃取或操纵客户会话和cookie，用于模仿合法用户，从而使黑客能够以该用户身份查看或变更用户记录以及执行事务。','1，Cookie或Session中id应该具有随机性，不易被拆解或构造；\n2，用户提交数据以POST方式提交；\n3，始终生成新的会话，修改后台逻辑，在验证登录逻辑的时候，先强制让当前Cookie和Session过期，然后用新的Cookie和Session存储信息。'),(58,'WEB漏洞','Oauth认证缺陷','OAuth是一个在不提供用户名和密码的情况下，授权第三方应用访问Web资源的安全协议。Oauth认证不完全，可越权登录他人账户','1，各应用除了验证access token之外，还必须辅助其他参数进行判断（比如自行加入其它认证参数进行双重认证）\n2，另一种方法则是验证access token背后所属的应用app key的唯一性和对应性（无论是自行验证还是开放平台通过签名等形式帮助验证），确保该access token是该应用的。'),(60,'WEB漏洞','CORS跨域资源共享漏洞','跨域资源共享(cors)可以放宽浏览器的同源策略，可以通过浏览器让不同的网站和不同的服务器之间通信。当服务器开启CORS功能是，如果响应包返回的报文头Access-Control-Allow-Credentials为true时，攻击者可利用该配置缺陷创建一个特殊的JavaScript脚本去发送CORS请求，从而窃取用户的敏感数据。','1，评估业务需求，如无跨域需求尽量避免开启CORS功能。\n2，定义白名单，仅允许可信源的跨域请求。\n3，“Access-Control-Allow-Credentials”标头设置为“true”时允许跨域请求中带有凭证数据，非必要情况下建议把值设置成“false\"'),(61,'WEB漏洞','jQuery版本过低','jQuery版本过低，存在跨站等众多安全漏洞','1，升级jQuery到最新版本；\n2，升级后删除旧版jQuery'),(62,'WEB漏洞','跨站请求伪造（CSRF）','CSRF攻击迫使终端用户在通过验证后在web应用中执行不必要的行动。在社会工程帮助下(如通过电子邮件/聊天发送的链接)，攻击者可能会迫使 Web应用程序用户执行攻击者所选择的行动','1，通过Referer判断页面来源进行CSRF防护；\n2，重要功能点使用动态验证码进行CSRF防护；\n3，通过Token方式进行CSRF防护：\n在Session中绑定token。如果不能保存到服务器端Session中，则可以替代为保存到Cookie里；\n在form表单中自动填入token字段，比如 <input type=hidden name=\"anti_csrf_token\" value=\"$token\" />；\n在HTTP请求中自动添加token；为每个session创建唯一的随机字符串，并在受理请求时验证。'),(63,'WEB漏洞','代码注入','代码注入是指攻击者提交代码作为输入，并被 web 服务器当作动态代码或嵌入文件处理。','正确过滤用户输入；'),(64,'WEB漏洞','命令注入','OS命令注入是尝试通过 HTTP 请求注入一个OS命令到应用程序中，在 web 服务器执行OS命令。','1，禁止执行外部输入的应用或命令；\n2，使用自定义函数或函数库实现外部应用或命令的功能；\n3，在执行system、eval等命令执行功能的函数前，确定参数内容。'),(65,'WEB漏洞','XXE','XML外部实体注入，XML的支持被称为“外部实体”，它指示XML处理器来检索和执行的内联包括位于一个特定URI的XML的设施。外部XML实体可以使用附加或修改与XML文档相关联的文档类型定义（DTD）。外部XML实体也可用于包括XML文档的内容中的XML。','1，检查所使用的底层xml解析库，默认禁止外部实体的解析\n2，增强对系统的监控，防止此问题被人利用；'),(66,'WEB漏洞','服务端请求伪造（SSRF）','一些web应用提供了从其他服务器获取数据的功能，指定的URL，web应用可以获取图片，下载文件，读取文件内容等。如果这个功能没有正确的做出限制，则很有可能被利用，我们称之为服务端请求伪造攻击（SSRF）。可以被利用作为代理攻击远程和本地的服务器等为攻击者进一步攻击提供便利等。','1，过滤返回信息，在返回给用户之前先验证返回的信息是否符合标准。\n2，自定义错误信息，防止根据错误信息来判断远端服务器的端口状态。\n3，限制请求的端口为http常用的端口，比如，80,443,8080,8090。\n4，黑名单内网ip。避免应用被用来获取获取内网数据，攻击内网。\n5，禁用不需要的协议。仅仅允许http和https请求。可以防止类似于file:///,gopher://,ftp:// 等引起的问题。\n6，如果web应用提供的功能是获取某一种文件类型，比如图片，则可以限制为jpg等。'),(67,'WEB漏洞','本地文件包含','本地文件包含是指程序代码在处理包含文件的时候没有严格控制，导致用户可以构造参数包含目标服务器上的代码并执行，并得到网站配置或者敏感文件，进而获取到服务器权限，造成网站被恶意删除，用户和交易数据被篡改等一系列恶性后果','①\n1，PHP：配置php.ini关闭文件包含功能(allow_url_include = Off)；\n2，严格检查变量是否已经初始化；\n3，对所有输入提交可能包含的文件地址（服务器本地文件及远程文件）进行严格的检查，参数中不允许出现../之类的目录跳转符；\n4，严格检查include类的文件包含函数中的参数是否外界可控；\n5，关键的过滤步骤在服务端进行；\n6，在发布应用程序之前测试所有已知的威胁。'),(68,'WEB漏洞','垂直越权访问','垂直越权访问，是指应用在检查授权（Authorization）时存在纰漏，使得攻击者在获得低权限用户帐后后，可以利用一些方式绕过权限检查，访问或者操作到原本无权访问的高权限功能。','1，服务器接收到用户发送的页面访问请求时，根据预设的识别策略，从用户的页面访问请求中提取该用户对应的用户唯一标识信息，同时提取所述页面访问请求对应的应答页面中的表单及该表单中不可修改参数，将所述表单及不可修改参数与所述用户唯一标识信息绑定后记录到参数列表中；\n2，检测到用户提交请求页面的表单时，将所述请求页面的表单及不可修改参数与该用户对应的所述参数列表中记录的表单及不可修改参数进行比对，控制该用户的访问。'),(70,'WEB漏洞','远程文件包含','文件包含是指程序代码在处理包含文件的时候没有严格控制，导致用户可以构造参数包含远程代码在服务器上执行，并得到网站配置或者敏感文件，进而获取到服务器权限，造成网站被恶意删除，用户和交易数据被篡改等一系列恶性后果。','1，过滤../ ./\n2，配置php.ini文件\n3，关闭allow_url_fopen 和 allow_url_include\n4，设置白名单'),(71,'WEB漏洞','目录遍历','攻击者可以利用目录遍历漏洞查看到网站目录结构及文件对网站发动进一步的攻击，甚至可以直接拿到网站的控制权限。','过滤.(点)等可能的恶意字符；正则判断用户输入的参数的格式，看输入的格式是否合法。'),(72,'WEB漏洞','入侵痕迹残留','在渗透过程中发现应用中存在曾经的入侵痕迹，如存在的webshell文件','可借助工具全盘清理入侵痕迹，如D盾可以扫描Windows系统中的webshell'),(73,'WEB漏洞','短信轰炸','攻击者通过网站页面中所提供的发送短信验证码的功能，通过对其发送数据包的获取后，进行重放，系统会一直去发送短信，造成短信轰炸漏洞。','限制同一号码发送间隔，如每分钟一条短信或者限制每天的短信发送上限，限制同一个ip每天的短信发送上限，如每天1000条'),(74,'WEB漏洞','恶意注册','系统用户注册功能可以被攻击者进行批量注册的操作。','增加机器不易识别的验证码，实时更新验证码，并在服务器端进行验证。'),(75,'WEB漏洞','登录认证绕过','如果被测应用没有使用有效的token机制，对登陆响应中的服务器返回的鉴权信息进行修改，即可绕过服务器鉴权，直接访问系统内部信息','使用有效的token机制进行鉴权'),(76,'WEB漏洞','密码找回逻辑缺陷','web应用系统密码找回功能存在逻辑设计缺陷，可以重制用户密码，非法进入web系统。','1，对于使用邮件或手机进行链接密码重置功能，当要发送重置密码相关认证信息时，要在服务器端验证用户发送者的邮件、手机号信息，判断是否与系统数据库一致。\n2，增加验证码长度（6位及以上）、复杂度（大小写字母和数字）及有效时间（3分钟以内）。\n3，在服务器端进行密码找回逻辑的判断。'),(77,'WEB漏洞','业务办理、查询','1、	当A查询自己剩余话费时，若业务流程只通过单一参数如手机号进行查询，A可修改手机号越权查询B的信息。\n2、	当A办理购买甲套餐（价格10元，数量1件），若业务流程没有对金额和数量做严格校验，A可任意修改金额和购买数量。\n3、	当A进行某网站抽奖时，若业务流程未正确处理抽奖次数，','对用户提交的参数进行签名合法性校验，业务流程处理时对session做验证，当发现参数存在被篡改情况，立刻终止业务流程'),(78,'WEB漏洞','中间件弱口令','中间件	用户名/密码\nDubbo	root/root\nHikvision	admin/12345\niMana	root/Huawei12#$\nkingtopcms	admin/toprand\nshipyard	admin/shipyard\nwdcp	admin/wdlinux.cn\nweblogic	weblogic/weblogic\n	system/system\n	system/ weblogic\n	portaladmin/portaladmin\n	guest/guest\nZabbix	Admin/zabbix\n	admin/zabbix\nJBoss	admin/admin\n	jboss/jboss\nTomcat	Admin/admin\n	Tomcat/tomcat','中间件管理端避免使用默认密码以及简单密码'),(79,'WEB漏洞','Weblogic反序列化漏洞','weblogic中间件存在反序列化漏洞，允许攻击者在服务器上执行任意命令','1，升级Weblogic官方补丁；\n2，对服务器进行全面检查，及时排查、删除服务器木马文件；\n3，修改服务器上明文存储的配置文件中用户名，密码等配置文件；\n4，对与该服务器可通信的相关服务器，进行安全性检查。'),(80,'WEB漏洞','Shiro RememberMe 反序列化远程代码执行漏洞','Apache Shiro 是企业常见的Java安全框架，在它编号为550的 issue 中爆出严重的 Java 反序列化漏洞。','1，升级Shiro到最新版\n2，升级对应JDK版本到 8u191/7u201/6u211/11.0.1 以上'),(81,'WEB漏洞','Fastjson 反序列化远程代码执行漏洞','FastJson是开源JSON解析库，应用范围非常广，攻击者可以通过发送精心制造的请求包，在使用Fastjson的服务器上远程执行代码。','1，升级Fastjson到最新版(>=1.2.68 新增了safemode, 彻底关闭autotype)\n2，升级对应JDK版本到 8u191/7u201/6u211/11.0.1 以上'),(82,'WEB漏洞','Jackson反序列化远程代码执行漏洞','FasterXML/jackson-databind是一个用于JSON和对象转换的Java第三方库，可将Java对象转换成json对象和xml文档，同样也可将json对象转换成Java对象。Jackson 跟Fastjson一样, 当enableDefaultTyping开启时, 也是可以进行反序列化到代码执行。','1，升级Jackson到最新版，确保enableDefaultTyping是关闭的\n2，升级对应JDK版本到 8u191/7u201/6u211/11.0.1 以上。'),(83,'WEB漏洞','Apache Druid 远程代码执行漏洞 (CVE-2021-25646)','Apache Druid 默认情况下缺乏授权认证，攻击者可以发送特制请求，利用Druid服务器上进程的特权执行任意代码','升级到最新版Apache Druid 0.20.1或更高版本'),(84,'WEB漏洞','列目录','列目录漏洞是由于网站存在配置缺陷，存在目录可浏览漏洞，这会导致网站很多隐私文件与目录泄露，比如数据库备份文件、配置文件等，攻击者利用该信息可以更容易得到网站权限，导致网站被黑','配置文件中修改相关参数，关闭路径浏览功能。\n例如：检查Apache配置文件中对列目录功能的设置，关闭列目录功能；对于IIS取消目录浏览功能'),(85,'WEB漏洞','Web服务器多余端口开放','Web应用服务器除业务端口外还会开放一些默认端口（如Jboss开放的8083），这些默认端口对最终用户是不需要开放的，而且也不会用于维护，容易被攻击，本测试目的在于发现服务器上未使用的Web端口。','关闭不必要的服务端口。'),(86,'WEB漏洞','默认页面泄漏','存在默认安装中间件、插件、框架等会携带示例页面及说明文档','建议在不影响业务的前提下删除默认页面'),(87,'WEB漏洞','Web控制台泄漏','Web 控制台是一种基于 Web 的用户界面， 其常常被用于网站后台或者web容器控制台中，其不仅仅局限于容器或者网站管理后台，还包括一些数据库默认地址等。在web安全中，网站系统在泄漏其web容器（中间件）或者数据库的控制台后，存在增加被入侵的风险。常见的web控制台包括以下多种：tomcat、aria2、weblogic、websphere、oracle、jboss、等。这些web的容器控制台常见访问形式：http://hostname:port/load/，例如：http://x.x.x.x:8080/manage/。','1，对于必须暴露于公网或者其他网络中的控制台地址，则为其地址做访问白名单措施，即只允许白名单以内的用户IP地址可以访问到该控制台，通过过滤器（filter）实现；\n2，修改控制台默认的用户名和密码，并为其控制台设置强壮的口令措施，防止被猜解得到用户名和密码；\n3，修改web容器控制台的默认端口，默认路径，避免可被直接利用访问得到地址；\n4，例如：\nTomcat6.0的修复方式：禁止别人访问tomcat主页。\n步骤1：在server.xml中 <Host name=\"localhost\" appBase=\"webapps\"修改改webapps为xxxxxx（自己设置的路径）；\n步骤2：在tomcat-users.xml中 ：<user name=\"admin\" password=\"xxxx\" roles=\"admin,manager\" /> 更改用户名和密码。'),(88,'WEB漏洞','不安全的存储方式','对重要信息不进行加密处理或加密强度不够，或者将不加密或加密的敏感信息放置在前台输出，都会导致攻击者获得重要信息。','服务端在返回用户密码信息时，以*号传输相关内容，即用户密码信息在服务端加密，禁止在客户端进行加密存储。'),(89,'WEB漏洞','HTML中的敏感信息','前端源码注释中含有系统相关敏感信息，例如：测试账号密码、加解密key、测试token、个人隐私信息等','发布上线前，确保HTML页面中不含有敏感信息。'),(90,'WEB漏洞','IIS写权限开启','因WEB服务器扩展里设置WebDAV为允许或是网站权限配置里开启了写入权限，允许攻击者上传webshell文件到服务器，导致服务器沦陷。','1，关闭OPTIONS方法，避免泄露支持方法；\n2，关闭IIS的PUT方法以及对目录权限进行限制。'),(91,'WEB漏洞','webpack泄露','webpack是一个JavaScript应用程序的静态资源打包器（module bundler）。它会递归构建一个依赖关系图（dependency graph）,其中包含应用程序需要的每个模块，可以直接使用浏览器的调试模式进行查看，有可能泄露的各种信息如API、加密算法、管理员邮箱、内部功能等等','打包时在项目路径下config/index.js中进行这样的修改\nbuild:{\n    productionSourceMap: false,//默认都是true,将其置为false\n}'),(92,'WEB漏洞','springboot env未授权访问','Actuator 是 springboot 提供的用来对应用系统进行自省和监控的功能模块，借助于 Actuator 开发者可以很方便地对应用系统某些监控指标进行查看、统计等。在 Actuator 启用的情况下，如果没有做好相关权限控制，非法用户可通过访问默认的执行器端点（endpoints）来获取应用系统中的监控信息。','对未授权访问页面进行权限控制，未经授权不能访问这些页面。'),(93,'WEB漏洞','Weblogic Console权限绕过漏洞（cve-2020-14750）','该漏洞是CVE-2020-14882 补丁的绕过，远程攻击者可以构造特殊的HTTP请求，在未经身份验证的情况下接管WebLogic Server Console，从而WebLogic Server Console执行任意代码。','及时升级官方补丁，参考：https://www.oracle.com/security-alerts/alert-cve-2020-14750.html。'),(94,'WEB漏洞','Apache Struts2 远程代码执行漏洞（S2-046）','当基于Jakarta插件上传文件时，可导致远程代码执行。例如在系统中获得管理员权限，执行添加用户，可任意查看、修改或删除文件。','1、	升级struts2框架的版本。\n2、	临时修复建议：可以在Struts2配置文件中关闭动态方法调用来避免漏洞被利用，配置属性信息<constantname“struts.enable.DynamicMethodInvocation”value=“false”/>。'),(95,'WEB漏洞','elasticsearch信息泄露','ElasticSearch 是一款Java编写的企业级搜索服务，启动此服务默认会开放HTTP-9200端口，可被非法操作数据。','对未授权访问页面进行权限控制，未经授权不能访问这些页面。'),(96,'WEB漏洞','spark未授权访问漏洞','Apache Spark 是一款集群计算系统，其支持用户向管理节点提交应用，并分发给集群执行。如果管理节点未启动访问控制，攻击者可以在集群中执行任意代码。该漏洞的本质是未授权用户可以向Master节点提交一个应用，Master 节点会分发给 Slave 节点执行应用。如果应用中包含恶意代码，会导致任意代码执行，威胁Spark集群整体的安全性。','1、对外关闭敏感端口；\n2、配置用户权限认证。'),(97,'WEB漏洞','redis未授权访问漏洞','redis默认情况下，会绑定在0.0.0.0:6379，如果没有进行采用相关的策略，比如添加防火墙规则避免其他非信任来源ip访问等，这样将会将 Redis 服务暴露到公网上，如果在没有设置密码认证（一般为空）的情况下，会导致任意用户在可以访问目标服务器的情况下未授权访问Redis以及读取 Redis 的数据。\n攻击者在未授权访问 Redis 的情况下，利用Redis自身的提供的config命令，可以进行写文件操作，攻击者可以成功将自己的ssh公钥写入目标服务器的/root/.ssh文件夹的authotrized_keys文件中，进而可以使用对应私钥直接使用ssh服务登录目标服务器。','1、以低权限运行 Redis 服务\n2、为 Redis 添加密码验证'),(98,'WEB漏洞','HTTP.SYS远程代码执行漏洞（MS15-034）','远程执行代码漏洞存在于HTTP协议堆栈 (HTTP.sys)中，当HTTP.sys未正确分析经特殊设计的HTTP请求时会导致此漏洞。','1、针对windows server R2 2008的服务器，补丁下载地址：https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2015/ms15-034。\n2、针对windows server R2 2012的服务器，补丁下载地址：https://www.microsoft.com/zh-cn/download/confirmation.aspx?id=46500。'),(99,'WEB漏洞','Windows RDP远程代码执行漏洞 (CVE-2019-0708)','2019年5月15日微软发布安全补丁修复了CVE编号为CVE-2019-0708的Windows远程桌面服务（RDP）远程代码执行漏洞,该漏洞在不需身份认证的情况下即可远程触发,危害与影响面极大。','1、升级windows的版本。\n2、打上cve-2019-0708的补丁。'),(100,'WEB漏洞','iis短文件夹漏洞','Internet Information Services（IIS，互联网信息服务）是由微软公司提供的基于运行Microsoft Windows的互联网基本服务。Microsoft IIS在实现上存在文件枚举漏洞，攻击者可利用此漏洞枚举网络服务器根目录中的文件。','1、关闭NTFS 8.3文件格式的支持。该功能默认是开启的，对于大多数用户来说无需开启。\n2、如果是虚拟主机空间用户,可采用以下修复方案：\n1）修改注册列表\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\FileSystem\\NtfsDisable8dot3NameCreation的值为1(此修改只能禁止NTFS8.3格式文件名创建,已经存在的文件的短文件名无法移除)。\n2）如果你的web环境不需要asp.net的支持你可以进入Internet 信息服务(IIS)管理器 --- Web 服务扩展 - ASP.NET 选择禁止此功能。\n3）升级net framework 至4.0以上版本。\n3、将web文件夹的内容拷贝到另一个位置，比如D:\\www到D:\\www.back，然后删除原文件夹D:\\www，再重命名D:\\www.back到D:\\www。如果不重新复制，已经存在的短文件名则是不会消失的。\n对于虚拟主机空间用户，如果还不能彻底修复该问题，可以联系空间提供商协助修改。'),(101,'WEB漏洞','Apache Tomcat任意文件读取漏洞 (CVE-2020-1938)','Tomcat是Apache软件基金会中的一个重要项目，性能稳定且免费，是目前较为流行的Web应用服务器，该漏洞是由于Tomcat AJP协议存在缺陷而导致，攻击者利用该漏洞可通过构造特定参数，读取服务器webapp下的任意文件，进而控制服务器，该漏洞利用难度低，目前互联网已存在漏洞利用工具。','1、临时禁用AJP协议端口，在conf/server.xml配置文件中注释\n<Connector port=\"8009\" protocol=\"AJP/1.3\" \nredirectPort=\"8443\" />\n2、配置ajp配置中的secretRequired跟secret属性来限制认证\n3、官方下载最新版下载地址：\nhttps://tomcat.apache.org/download-70.cgi\nhttps://tomcat.apache.org/download-80.cgi\nhttps://tomcat.apache.org/download-90.cgi'),(102,'WEB漏洞','XPATH注入','XPath注入攻击是指利用XPath 解析器的松散输入和容错特性，能够在URL、表单或其它信息上附带恶意的XPath 查询代码，以获得权限信息的访问权并更改这些信息。\nXPath注入攻击是针对Web服务应用新的攻击方法，它允许攻击者在事先不知道XPath查询相关知 识的情况下，通过XPath查询得到一个XML文档的完整内容。','1、	数据提交到服务器上端，在服务端正式处理这批数据之前，对提交数据的 合法性进行验证。\n2、	检查提交的数据是否包含特殊字符，对特殊字符进行编码转换或替换、删 除敏感字符或字符串。\n3、	对于系统出现的错误信息，以 IE 错误编码信息替换，屏蔽系统本身的出错 信息。\n4、	参数化 XPath 查询，将需要构建的 XPath 查询表达式，以变量的形式表 示，变量不是可以执行的脚本。如下代码可以通过创建保存查询的外部文件使查 询参数化： declare variable $loginID as xs：string external； declare variable $password as xs：string external； //users/user[@loginID=$loginID and @password= $password]。\n5、	通过 MD5、 SSL 等加密算法， 对于数据敏感信息和在数据传输过程中加密， 即使某些非法用户通过非法手法获取数据包，看到的也是加密后的信息。'),(103,'WEB漏洞','xff注入','XFF，是X-Forwarded-for的缩写，XFF注入是SQL注入的一种，该注入原理是通过修改X-Forwarded-for头对带入系统的dns进行sql注入，从而得到网站的数据库内容。','过滤http头中的X-Forwarded-for header中的内容，不允许其插入敏感字符，过滤字符参考sql注入修复方案。'),(104,'WEB漏洞','链接或框架注入','攻击者有可能注入含有恶意内容的 frame 或 iframe 标签。如果用户不够谨慎，就有可能浏览该标签所对应的页面，但意识不到自己会离开原始站点而进入恶意的站点。之后，攻击者便可以诱导用户再次登录，然后获取其登录凭证。','建议过滤以下所有字符：| & ； $ % @ \' \" \\\' \\\" <> () + CR LF , \\。'),(105,'WEB漏洞','json注入','JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式。易于人阅读和编写。同时也易于机器解析和生成，这种纯文本的数据交互方式由于可以天然的在浏览器中使用，所以随着ajax和web业务的发展得到了广大的发展，各种大型网站都开始使用，包括Yahoo，Google，Tencent，Baidu等等，目前各银行都有用这种方式来实现数据交互。但是如果这种交互的方式用来传递敏感的数据，并且传输的时候没有做太多安全性控制的话将导致安全漏洞，根据敏感信息的不同导致会导致应用遭受不同级别的攻击。','尽量避免跨域的数据传输，对于同域的数据传输使用xmlhttp的方式作为数据获取的方式，依赖于javascript在浏览器域里的安全性保护数据。如果是跨域的数据传输，必须要对敏感的数据获取做权限认证，具体的方式可以包括：\n1、referer的来源限制，利用前端referer的不可伪造性来保障请求数据的应用来源于可信的地方，此种方式力度较稀，完全依赖于referer，某些情况下（如存在xss）可能导致被绕过。\n2、token的加入，严格来说，这种利用javascript hijacking的方式获取数据是CSRF的一种，不过较之传统的CSRF不能获取数据只能提交而言，这种方式利用javascript可以获取一些敏感信息而已。如果我们能让攻击者对接口未知，就可以实现json hijacking的防御了。利用token对调用者的身份进行认证，这种方式对于调用者的身份会要求力度较细，但是一旦出现xss也可能导致前端Token的泄露，从而导致保护失效。\n3、对于同域的json使用情况下，可以在数据的输出头部加入while(1);的方式避免数据被script。'),(106,'WEB漏洞','服务器模版注入（SSTI）','SSTI （服务器端模板注入）如果攻击者能够控制要呈现的模板，服务端接收了用户的恶意输入以后，未经任何处理就将其作为 Web 应用模板内容的一部分，模板引擎在进行目标编译渲染的过程中，执行了用户插入的可以破坏模板的语句，就可能导致上下文数据的暴露，甚至在服务器上运行任意命令的表达式。','1、	不要让用户对传入模板的内容或者模板本身进行控制。\n2、	减少或者放弃直接使用格式化字符串结合字符串拼接的模板渲染方式。\n3、	如果需要将动态数据传递给模板，不要直接在模板文件中执行，可以使用模板引擎的内置功能来扩展表达式，实现同样的效果。'),(107,'WEB漏洞','jboss命令执行漏洞','根源在CommonsCollections组件中对于集合的操作存在可以进行反射调用的方法,并且该方法在相关对象反序列化时并未进行任何校验，导致远程代码执行。利用漏洞，允许攻击者远程执行系统命令，获得服务器权限，导致服务器运行安全风险。','1、针对JBoss Java反序列化漏洞，建议更新jboss版本到最新版（http://www.jboss.org/）或 更新官方补丁。\n2、针对数据库帐号密码进行修改，要求密码长度8位数以上，密码复杂程度必须包含数字、大小写字母及特殊字符。\n3、对服务器进行全面安全检查，及时排查、清除webshell等后门文件；及时修改数据库密码等。'),(108,'WEB漏洞','ms17-010远程代码执行漏洞','当Microsoft服务器消息块 1.0 (SMBv1) 服务器处理某些请求时，存在多个远程执行代码漏洞。成功利用这些漏洞的攻击者可以获取在目标系统上执行代码的能力。\n为了利用此漏洞，在多数情况下，未经身份验证的攻击者可能向目标 SMBv1 服务器发送经特殊设计的数据包。','1、升级windows的版本。\n2、打上ms17-010的补丁。'),(109,'WEB漏洞','thinkphp命令执行漏洞','ThinkPHP是一个快速、兼容而且简单的轻量级国产PHP开发框架，诞生于2006年初。该框架常被用来进行二次开发，国内应用非常广泛。\nThinkPHP在实现上，获取控制器名称时未对用户提交的参数进行严格过滤，在没有开启强制路由的情况下，攻击者可以通过输入’\\’字符的方式调用任意方法，进行命令执行攻击。','升级至ThinkPHP最新版本。'),(110,'WEB漏洞','java rmi命令执行','RMI是REMOTE METHODINVOCATION的简称，是J2SE的一部分，能够让程序员开发出基于JAVA的分布式应用。一个RMI对象是一个远程JAVA对象，可以从另一个JAVA虚拟机上（甚至跨过网络）调用它的方法，可以像调用本地JAVA对象的方法一样调用远程对象的方法，使分布在不同的JVM中的对象的外表和行为都像本地对象一样。对于任何一个以对象为参数的RMI接口，你都可以发一个自己构建的对象，迫使服务器端将这个对象按任何一个存在于class path中的可序列化类来反序列化。','1、关闭rmi服务的端口在公网的开放；\n2、下载SerialKiller临时补丁，这个jar后放置于classpath，将应用代码中的java.io.ObjectInputStream替换为SerialKiller，之后配置让其能够允许或禁用一些存在问题的类，SerialKiller有Hot-Reload,Whitelisting,Blacklisting几个特性，控制了外部输入反序列化后的可信类型\n3、在不影响业务的情况下，临时删除掉项目里的InvokerTransformer.class文件；\n4、定时对WebLogic、Apache、JBoss等中间件进行升级。'),(111,'WEB漏洞','iis6.0远程代码执行漏洞','Microsoft Windows Server 2003 R2中的IIS 6.0版本中的WebDAV服务的“ScStoragePathFromUrl”函数存在缓冲区溢出漏洞（CNNVD-201703-1074，对应CVE-2017-7269）。通过代码可以看到在ScStoragePathFromUrl函数中，其尾部调用memcpy函数时，对于拷贝的目的地址来自于函数的参数，而函数的参数为上层函数的局部变量，保存在上层函数的栈空间中。但是在调用memcpy函数时，没有判断要拷贝的源字符长度，从而导致了栈溢出。','1、	由于微软官方已停止对windows server 2003的 技术支持， 强烈建议 仍在使用IIS6的客户升级使用2008、2012或更新的操作系统及对应的IIS版本。\n2、	如果目前无法及时升级操作系统及IIS版本，请及时检查服务器是否已经被入侵，并 关闭WebDAV服务。'),(112,'WEB漏洞','elasticsearch远程代码执行漏洞','该漏洞存在于一个名为ElasticSearch.yml的文件，在这个文件中存在一个配置项“script.disable_dynamic”，默认为“false”。此默认配置允许服务器动态执行用户发送的任意代码。黑客只需要通过一个URL地址向服务器传送一段代码，就可以创建和执行他们自己的程序。一旦黑客获得通过，他们在服务器上的操作将不受任何限制，包括窃取网站中的用户账号及密码等敏感信息，或者留下一个后门程序。','1、升级最新版本；\n2、系统如果不再使用 ，请将其下线或用防火墙屏蔽。'),(113,'WEB漏洞','Resin任意文件读取漏洞','安装某些版本Resin服务器的网站存在可读取任意文件的漏洞，攻击者利用该漏洞可以读取网站服务器的任意文件内容。','1、升级最新版本；\n2、系统如果不再使用 ，请将其下线或用防火墙屏蔽。'),(114,'WEB漏洞','GNU Bash远程命令执行漏洞','GNU Bash 4.3及之前版本在评估某些构造的环境变量时存在安全漏洞，向环境变量值内的函数定义后添加多余的字符串会触发此漏洞，攻击者可利用此漏洞改变或绕过环境限制，以执行shell命令。','1、升级最新版本；\n2、系统如果不再使用 ，请将其下线或用防火墙屏蔽。'),(115,'WEB漏洞','Apache ActiveMQ远程代码执行','ActiveMQ是Apache软件基金会下的一个开源消息驱动中间件软件。ActiveMQ中的fileserver服务允许用户通过HTTP PUT方法上传文件到指定目录。Fileserver支持写入文件(不解析jsp),但是支持移动文件(Move)我们可以将jsp的文件PUT到Fileserver下,然后再通过Move指令移动到可执行目录下访问。','1、ActiveMQ Fileserver 的功能在 5.14.0 及其以后的版本中已被移除。建议用户升级至 5.14.0 及其以后版本。\n2、通过移除 conf\\jetty.xml 的以下配置来禁用 ActiveMQ Fileserver 功能。'),(116,'WEB漏洞','SSH支持弱加密算法漏洞','SSH的配置文件中加密算法没有指定，默认支持所有加密算法，包括arcfour,arcfour128,arcfour256等弱加密算法。\n这个漏洞属于SSH的配置缺陷，SSH服务启用了Arcfour （也称RC4）这个不安全算法。','1、修改SSH配置文件，添加加密算法：vi /etc/ssh/sshd_config\n2、最后面添加以下内容（去掉arcfour,arcfour128,arcfour256等弱加密算法）：Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc\n3、保存文件后重启SSH服务：service sshd restart or service ssh restart\n4、验证：\nssh -vv -oCiphers=aes128-cbc,3des-cbc,blowfish-cbc <server>\nssh -vv -oMACs=hmac-md5 <server>'),(117,'WEB漏洞','OpenSSH 用户名枚举漏洞（CVE-2018-15473）','OpenSSH 7.7前存在一个用户名枚举漏洞，通过该漏洞，攻击者可以判断某个用户名是否存在于目标主机中。','升级OpenSSH至最新版本。'),(118,'WEB漏洞','Oracle Database Server TNS Listener远程漏洞','Oracle Database Server是一个对象关系数据库管理系统。\nOracle Database Server在实现上存在可允许攻击者向远程“TNS Listener”组件处理的数据投毒的漏洞。攻击者可利用此漏洞将数据库服务器的合法“TNS Listener”组件中的数据转向到攻击者控制的系统，导致控制远程组件的数据库实例，造成组件和合法数据库之间的攻击者攻击、会话劫持或拒绝服务攻击。','目前厂商已经发布了升级补丁以修复此安全问题，补丁获取链接：\nhttp://www.oracle.com/technetwork/topics/security/alert-cve-2012-1675-1608180.html'),(119,'WEB漏洞','weblogic未授权访问漏洞(CVE-2020-14883)','CVE-2020-14883允许后台任意用户通过HTTP协议执行任意命令。使用这两个漏洞组成的利用链，可通过一个GET请求在远程Weblogic服务器上以未授权的任意用户身份执行命令。','下载补丁程序并安装更新');
/*!40000 ALTER TABLE `api_program` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2022-02-22  1:49:46
